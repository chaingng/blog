+++
title = "SRM 577 DIV1 Easy - EllysRoomAssignmentsDiv1 x"
date = 2015-05-27T16:30:00Z
updated = 2015-08-06T09:57:04Z
blogimport = true 
[author]
	name = "chngng"
	uri = "https://www.blogger.com/profile/14196381724208675248"
+++

<div dir="ltr" style="text-align: left;" trbidi="on"><h3 style="border-bottom: 2px solid slateblue; border-left: 8px solid navy; color: black; padding: 0px 0px 1px 5px;">問題 <br /></h3><br /><a href="http://community.topcoder.com/stat?c=problem_statement&amp;pm=12514&amp;rd=15497" target="_blank">http://community.topcoder.com/stat?c=problem_statement&amp;pm=12514&amp;rd=15497</a><br /><br /><h3 style="border-bottom: 2px solid slateblue; border-left: 8px solid navy; color: black; padding: 0px 0px 1px 5px;">解き方 </h3><br />部屋の数Rから、部屋への割り当てが行われる回数Kが決まる。<br />K回の割り当てのうち、<br />自分が割り当てられる場合はその他のメンバーは関係なく、<br />また最後の割り当てのときはすべての部屋ではなく、ランダムに部屋へ割り当てられるので別に値を保持しておく。<br /><br />最後に、自分が最後の割り当てであれば部屋の人数はK人だけを考えればよく、<br />そうでなければK-1人となる確率pの期待値とK人である1-pの期待値の和が答えとなる。<br /><br /><h3 style="border-bottom: 2px solid slateblue; border-left: 8px solid navy; color: black; padding: 0px 0px 1px 5px;">コード </h3><br /><div style="background-color: #e3f2fb; border: 1px dotted #CCCCCC; padding: 5px;">class EllysRoomAssignmentsDiv1 {<br /><br /><span class="Apple-tab-span" style="white-space: pre;"> </span>public: double getAverage(vector&lt;string&gt; ratings) {<br /><span class="Apple-tab-span" style="white-space: pre;">  </span>int rates[1010],N=0;<br /><span class="Apple-tab-span" style="white-space: pre;">  </span>string input=accumulate(all(ratings),string());<br /><span class="Apple-tab-span" style="white-space: pre;">  </span>stringstream out(input);<br /><span class="Apple-tab-span" style="white-space: pre;">  </span>for(;out&gt;&gt;rates[N];)N++;<br /><span class="Apple-tab-span" style="white-space: pre;">  </span>int my=rates[0];<br /><br /><span class="Apple-tab-span" style="white-space: pre;">  </span>sort(rates,rates+N,greater&lt;int&gt;());<br /><span class="Apple-tab-span" style="white-space: pre;">  </span>int me=lower_bound(rates,rates+N,my,greater&lt;int&gt;())-rates;<br /><br /><span class="Apple-tab-span" style="white-space: pre;">  </span>int R=(N+19)/20;<br /><span class="Apple-tab-span" style="white-space: pre;">  </span>int K=(N+R-1)/R;<br /><br /><span class="Apple-tab-span" style="white-space: pre;">  </span>double sum=0,add=0;<br /><span class="Apple-tab-span" style="white-space: pre;">  </span>for(int i=0;i&lt;K;i++){<br /><span class="Apple-tab-span" style="white-space: pre;">   </span>if(R*i&lt;=me &amp;&amp; me&lt;R*(i+1)){<br /><span class="Apple-tab-span" style="white-space: pre;">    </span>sum+=rates[me];<br /><span class="Apple-tab-span" style="white-space: pre;">   </span>}else if(i==K-1){<br /><span class="Apple-tab-span" style="white-space: pre;">    </span>double tmp=0.0;<br /><span class="Apple-tab-span" style="white-space: pre;">    </span>for(int j=R*i;j&lt;N;j++)tmp+=rates[j];<br /><span class="Apple-tab-span" style="white-space: pre;">    </span>add+=tmp/(N-R*i);<br /><span class="Apple-tab-span" style="white-space: pre;">   </span>}else{<br /><span class="Apple-tab-span" style="white-space: pre;">    </span>double tmp=0.0;<br /><span class="Apple-tab-span" style="white-space: pre;">    </span>for(int j=R*i;j&lt;R*(i+1);j++)tmp+=rates[j];<br /><span class="Apple-tab-span" style="white-space: pre;">    </span>sum+=tmp/R;<br /><span class="Apple-tab-span" style="white-space: pre;">   </span>}<br /><span class="Apple-tab-span" style="white-space: pre;">  </span>}<br /><span class="Apple-tab-span" style="white-space: pre;">  </span>double p=(R*K-N)/(double)R;<br /><span class="Apple-tab-span" style="white-space: pre;">  </span>if(R*(K-1)&lt;=me)p=0;<br /><br /><span class="Apple-tab-span" style="white-space: pre;">  </span>double ret=0;<br /><span class="Apple-tab-span" style="white-space: pre;">  </span>if(p&gt;0)ret+=p*(sum/(K-1));<br /><span class="Apple-tab-span" style="white-space: pre;">  </span>ret+=(1-p)*((sum+add)/K);<br /><br /><span class="Apple-tab-span" style="white-space: pre;">  </span>return ret;<br /><span class="Apple-tab-span" style="white-space: pre;"> </span>}<br /><br />};</div></div>
