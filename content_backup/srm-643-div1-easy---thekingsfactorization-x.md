+++
title = "SRM 643 DIV1 Easy - TheKingsFactorization x○"
date = 2015-04-19T12:12:00Z
updated = 2015-08-08T06:52:08Z
tags = ["数学"]
blogimport = true 
[author]
	name = "chngng"
	uri = "https://www.blogger.com/profile/14196381724208675248"
+++

<div dir="ltr" style="text-align: left;" trbidi="on"><h3 style="border-bottom: 2px solid slateblue; border-left: 8px solid navy; color: black; padding: 0px 0px 1px 5px;">問題 </h3><br /><a href="http://community.topcoder.com/stat?c=problem_statement&amp;pm=13594&amp;rd=16086" target="_blank">http://community.topcoder.com/stat?c=problem_statement&amp;pm=13594&amp;rd=16086</a><br /><br />整数Nを素因数分解したい。<br />ただし、Nはとても大きいため、Nを素因数分解したときの答えの<br />昇順に1番目、3番目、、と一つ置きの因数が与えられる。<br />このとき、すべての因数を求める。<br /><br /><h3 style="border-bottom: 2px solid slateblue; border-left: 8px solid navy; color: black; padding: 0px 0px 1px 5px;">解き方 </h3><br />Nが最大で10^18のため計算量の考慮が必要。<br /><br />まず、Nを与えられた素因数で割ってから残りの数を求めようとすると<br />{2,(2),2,(10^16)}のときO(10^8)となり計算量オーバー。<br /><br />次に、与えられた素因数の間の数prime[i]とprime[i+1]の間を求めていくやり方も<br />{2,(2),10^16}のときO(10^16)となり計算量オーバー。<br /><br />そこで、両方の判定を加えてあげることで<br />{2,(2),10^6,(10^11)}の場合でも、最大でO(10^6)に収められる。<br /><br /><br /><h3 style="border-bottom: 2px solid slateblue; border-left: 8px solid navy; color: black; padding: 0px 0px 1px 5px;">コード </h3><br /><div style="background-color: #e3f2fb; border: 1px dotted #CCCCCC; padding: 5px;">class TheKingsFactorization {<br /><br /><span class="Apple-tab-span" style="white-space: pre;"> </span>public: vector&lt;long long&gt; getVector(long long N, vector&lt;long long&gt; primes) {<br /><span class="Apple-tab-span" style="white-space: pre;">  </span>int n=primes.size();<br /><span class="Apple-tab-span" style="white-space: pre;">  </span>FORE(i,0,n)N/=primes[i];<br /><br /><span class="Apple-tab-span" style="white-space: pre;">  </span>vector&lt;long long&gt; ans=primes;<br /><span class="Apple-tab-span" style="white-space: pre;">  </span>FORE(i,0,n-1){<br /><span class="Apple-tab-span" style="white-space: pre;">   </span>for(long long j=primes[i];j&lt;=primes[i+1] &amp;&amp; j*j&lt;=N;j++){<br /><span class="Apple-tab-span" style="white-space: pre;">    </span>while(N%j==0){<br /><span class="Apple-tab-span" style="white-space: pre;">     </span>ans.push_back(j);<br /><span class="Apple-tab-span" style="white-space: pre;">     </span>N/=j;<br /><span class="Apple-tab-span" style="white-space: pre;">    </span>}<br /><span class="Apple-tab-span" style="white-space: pre;">   </span>}<br /><span class="Apple-tab-span" style="white-space: pre;">  </span>}<br /><span class="Apple-tab-span" style="white-space: pre;">  </span>if(N!=1)ans.push_back(N);<br /><br /><span class="Apple-tab-span" style="white-space: pre;">  </span>sort(all(ans));<br /><br /><span class="Apple-tab-span" style="white-space: pre;">  </span>return ans;<br /><span class="Apple-tab-span" style="white-space: pre;"> </span>}<br /><br />};</div></div>
