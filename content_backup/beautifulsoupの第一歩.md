+++
title = "BeautifulSoupの第一歩"
date = 2014-01-31T23:22:00Z
updated = 2014-01-31T23:41:54Z
tags = ["technology"]
blogimport = true 
[author]
	name = "chngng"
	uri = "https://www.blogger.com/profile/14196381724208675248"
+++

<div dir="ltr" style="text-align: left;" trbidi="on"><br />クローラーで取ってきたHTMLを解析するのにBeautifulSoupが使いやすそうだったので使ってみました。以下は簡単な使い方のメモ。<br /><br /><h3 style="border-bottom: 2px solid slateblue; border-left: 8px solid navy; color: black; padding: 0px 0px 1px 5px;">バージョン</h3><br />BeautifulSoupは３と４がありますが<br />現在はBeautiful Soup３は終了していてBeautiful Soup４が主流とのこと。<br />Webをみていると３の使い方が多いので注意。<br />そしてPython3はBS3が使えないです。<br /><br /><h3 style="border-bottom-color: rgb(106, 90, 205); border-bottom-style: solid; border-bottom-width: 2px; border-left-color: navy; border-left-style: solid; border-left-width: 8px; padding: 0px 0px 1px 5px;">インポート</h3><br />まずはインポート。<br />BeautifulSoup4は以下の書き方になります。<br /><div style="background-color: #e3f2fb; border: 1px dotted #CCCCCC; padding: 5px;">from bs4 import BeautifulSoup</div><br /><br /><h3 style="border-bottom-color: rgb(106, 90, 205); border-bottom-style: solid; border-bottom-width: 2px; border-left-color: navy; border-left-style: solid; border-left-width: 8px; padding: 0px 0px 1px 5px;">まずは全文抽出</h3><div><br /></div>まずは、以下のように書くことでhtmlの全文が保存されます。<br /><div style="background-color: #e3f2fb; border: 1px dotted rgb(204, 204, 204); padding: 5px;">datas = BeautifulSoup(datas)</div><br /><br /><div style="-webkit-text-stroke-width: 0px; color: black; font-family: Meiryo; font-size: medium; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: normal; orphans: auto; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px;"></div><br /><h3 style="-webkit-text-stroke-width: 0px; border-bottom-color: rgb(106, 90, 205); border-bottom-style: solid; border-bottom-width: 2px; border-left-color: navy; border-left-style: solid; border-left-width: 8px; color: black; font-family: Meiryo; font-style: normal; font-variant: normal; letter-spacing: normal; line-height: normal; orphans: auto; padding: 0px 0px 1px 5px; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px;">findで指定のタグを抽出</h3><br />次にfind文で指定のタグを抽出できます。<br />今回はfindAll文を使うことで、html中の指定のタグを抽出しました。<br />以下ではdivタグのresult classを抽出。<br /><div style="background-color: #e3f2fb; border: 1px dotted rgb(204, 204, 204); padding: 5px;">datas2 = datas.findAll("div", attrs={"class": "result"})</div><br /><br /><div style="-webkit-text-stroke-width: 0px; color: black; font-family: Meiryo; font-size: medium; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: normal; orphans: auto; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px;"></div><br /><h3 style="-webkit-text-stroke-width: 0px; border-bottom-color: rgb(106, 90, 205); border-bottom-style: solid; border-bottom-width: 2px; border-left-color: navy; border-left-style: solid; border-left-width: 8px; color: black; font-family: Meiryo; font-style: normal; font-variant: normal; letter-spacing: normal; line-height: normal; orphans: auto; padding: 0px 0px 1px 5px; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px;">さらに下層の情報取得とテキスト抽出</h3><br />ここで抽出された情報は配列となっているので、<br />さらにそこから抽出したい情報があれば配列番号でアクセス。<br /><div style="background-color: #e3f2fb; border: 1px dotted rgb(204, 204, 204); padding: 5px;">result_name=datas2[1].find("h5").get_text().replace(' ','')<br />score=datas2[2].find("h5").get_text()</div><br />ここでは1番目と2番目にあるh5タグを抽出しています。<br />これまでだとタグと本文を含めてまとめて抽出されるので、<br />本文だけを取りだしたい場合はget_text()を利用。<br /><br />また、タグ内の属性情報を取り出したいときはget('href')など指定することで可能です。<br />タグ名を取りだしたいときは .nameで取れます。<br /><br /></div>
