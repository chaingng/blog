+++
title = "SRM 577 DIV1 -Level1"
date = 2013-08-18T17:13:00Z
updated = 2015-04-03T11:13:18Z
tags = ["シミュレーション"]
blogimport = true 
[author]
	name = "chngng"
	uri = "https://www.blogger.com/profile/14196381724208675248"
+++

<div dir="ltr" style="text-align: left;" trbidi="on"><h3 style="border-bottom: 2px solid slateblue; border-left: 8px solid navy; color: black; padding: 0px 0px 1px 5px;">問題 </h3><br />プログラミングコンテストを実施するにあたり、プレイヤーを部屋に割り当てる。<br />部屋は２０人単位。プレイヤーはレートをもっている。<br />部屋の割り当てはレートの高い順に最初の部屋数分を、ランダムにそれぞれの部屋に割り当てる。部屋数で割り切れない場合は、部屋にいる人数は必ずしも一緒にならない。<br /><br />配列の最初のプレイヤーが自分であるとき、<br />自分が割り当てられた部屋の平均レートを求める。<br /><br /><h3 style="border-bottom: 2px solid slateblue; border-left: 8px solid navy; color: black; padding: 0px 0px 1px 5px;">解き方 </h3><br />シミュレーション問題であるが、自分のレートによって色々な場合が存在するので全て洗い出す。また、コーディングをいかに単純にするかもポイント。<br /><br />コーディングを単純にするには、<br />まずは計算しやすい各割り当てグループごとにメンバーの平均値を求める。<br />そのグループに自分が入っている場合は、自分の値＝平均値となる。<br />最後のグループも同じように計算する。<br /><br />次にとりうる全てのケースを考える。<br />１）メンバーが部屋の数で割り切れるとき<br />　すべてのメンバーの平均値／部屋のメンバー数が答え。<br /><br />２）メンバーが部屋の数で割り切れないとき<br />　２－１）自分が最後の割り当てメンバーのとき<br />　　メンバー数が全メンバー／部屋数に１を足したものになるので、<br />　　全てのメンバーの平均値／上記のメンバー数が答え。<br />　２－２）自分が最後の割り当てメンバーではないとき<br />　　自分がメンバーの多い部屋になるときとならないときの確率を求めて<br />　　その２つの和が答えとなる。<br /><br />Challenge<br />int／intはint型の結果が代入される。<br />一方でdouble/int もしくはint/doubleはdoubleに変換されて計算される。<br />いずれにしても計算の場合は型を一致させてから行うのが基本。<br /><br /><h3 style="border-bottom: 2px solid slateblue; border-left: 8px solid navy; color: black; padding: 0px 0px 1px 5px;">コード </h3><br /><div style="background-color: #e3f2fb; border: 1px dotted #CCCCCC; padding: 5px;">class EllysRoomAssignmentsDiv1 {<br /><br /><span class="Apple-tab-span" style="white-space: pre;"> </span>public: double getAverage(vector&lt;string&gt; ratings) {<br /><span class="Apple-tab-span" style="white-space: pre;">  </span>string tmp="";<br /><span class="Apple-tab-span" style="white-space: pre;">  </span>vector&lt;int&gt; v;<br /><span class="Apple-tab-span" style="white-space: pre;">  </span>vector&lt;double&gt; ave;<br /><br /><span class="Apple-tab-span" style="white-space: pre;">  </span>ave.clear(),v.clear();<br /><span class="Apple-tab-span" style="white-space: pre;">  </span>FORE(i,0,ratings.size())tmp+=ratings[i];<br /><span class="Apple-tab-span" style="white-space: pre;">  </span>stringstream str(tmp);<br /><span class="Apple-tab-span" style="white-space: pre;">  </span>while(1){<br /><span class="Apple-tab-span" style="white-space: pre;">   </span>int out=-1;<br /><span class="Apple-tab-span" style="white-space: pre;">   </span>str&gt;&gt;out;<br /><span class="Apple-tab-span" style="white-space: pre;">   </span>if(out==-1)break;<br /><span class="Apple-tab-span" style="white-space: pre;">   </span>v.push_back(out);<br /><span class="Apple-tab-span" style="white-space: pre;">  </span>}<br /><br /><span class="Apple-tab-span" style="white-space: pre;">  </span>int N=v.size();<br /><span class="Apple-tab-span" style="white-space: pre;">  </span>int R=(N+19)/20;<br /><span class="Apple-tab-span" style="white-space: pre;">  </span>int myrate=v[0],my=0;<br /><span class="Apple-tab-span" style="white-space: pre;">  </span>int member=N/R;<br /><br /><span class="Apple-tab-span" style="white-space: pre;">  </span>sort(v.rbegin(),v.rend());<br /><span class="Apple-tab-span" style="white-space: pre;">  </span>FORE(i,0,v.size())if(v[i]==myrate)my=i;<br /><br /><span class="Apple-tab-span" style="white-space: pre;">  </span>for(int i=0;i&lt;N;i+=R){<br /><span class="Apple-tab-span" style="white-space: pre;">   </span>int j=min(i+R,N);<br /><span class="Apple-tab-span" style="white-space: pre;">   </span>double tmp=0;<br /><span class="Apple-tab-span" style="white-space: pre;">   </span>if(i&lt;=my &amp;&amp; my&lt;j){<br /><span class="Apple-tab-span" style="white-space: pre;">    </span>ave.push_back(myrate);<br /><span class="Apple-tab-span" style="white-space: pre;">    </span>continue;<br /><span class="Apple-tab-span" style="white-space: pre;">   </span>}<br /><span class="Apple-tab-span" style="white-space: pre;">   </span>FORE(k,i,j)tmp+=v[k];<br /><span class="Apple-tab-span" style="white-space: pre;">   </span>ave.push_back(tmp/(j-i));<br /><span class="Apple-tab-span" style="white-space: pre;">  </span>}<br /><br /><span class="Apple-tab-span" style="white-space: pre;">  </span>double sum=0;<br /><span class="Apple-tab-span" style="white-space: pre;">  </span>FORE(i,0,ave.size()-1)sum+=ave[i];<br /><br /><span class="Apple-tab-span" style="white-space: pre;">  </span>if(N%R==0)return (sum+ave[ave.size()-1])/member;<br /><span class="Apple-tab-span" style="white-space: pre;">  </span>if(my&gt;=N-N%R)return (sum+ave[ave.size()-1])/(member+1);<br /><br /><span class="Apple-tab-span" style="white-space: pre;">  </span>double p1=(N%R)/(double)R,p2=1-p1;<br /><span class="Apple-tab-span" style="white-space: pre;">  </span>return p1*(sum+ave[ave.size()-1])/(member+1)+p2*(sum/member);<br /><span class="Apple-tab-span" style="white-space: pre;"> </span>}<br /><br />};</div></div>
